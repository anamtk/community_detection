<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Collaborator Update November 2023</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="November_2023_collaboratorupdate_files/libs/clipboard/clipboard.min.js"></script>
<script src="November_2023_collaboratorupdate_files/libs/quarto-html/quarto.js"></script>
<script src="November_2023_collaboratorupdate_files/libs/quarto-html/popper.min.js"></script>
<script src="November_2023_collaboratorupdate_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="November_2023_collaboratorupdate_files/libs/quarto-html/anchor.min.js"></script>
<link href="November_2023_collaboratorupdate_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="November_2023_collaboratorupdate_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="November_2023_collaboratorupdate_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="November_2023_collaboratorupdate_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="November_2023_collaboratorupdate_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Collaborator Update November 2023</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="long-term-community-stability-accounting-for-detection-error-to-understand-the-contributions-of-current-and-past-environmental-conditions-to-community-states" class="level2">
<h2 class="anchored" data-anchor-id="long-term-community-stability-accounting-for-detection-error-to-understand-the-contributions-of-current-and-past-environmental-conditions-to-community-states">Long-term community stability: accounting for detection error to understand the contributions of current and past environmental conditions to community states</h2>
</section>
<section id="motivation" class="level2">
<h2 class="anchored" data-anchor-id="motivation">Motivation</h2>
<p>In this study, we’re interested in understanding how long-term datasets can help us understand how communities respond to environmental change. We’re also interested in accounting for detection error in this process - a practice that is well established in some sub-fields of ecology (e.g., wildlife ecology, mostly birds) but less so in others (e.g., community ecology, especially with non-bird focus). Our aim is to combine a two-part modeling process to first account for detection error in community datasets, and then use these datasets to derive standard values of community change/stability (e.g.&nbsp;dissimilarlity) that can then be used in a second model in which we ask how the environment (both current and past) shapes community change.</p>
</section>
<section id="guiding-questions" class="level2">
<h2 class="anchored" data-anchor-id="guiding-questions">Guiding questions</h2>
<section id="q1-how-are-estimates-of-community-stability-shaped-by-detection-error" class="level3">
<h3 class="anchored" data-anchor-id="q1-how-are-estimates-of-community-stability-shaped-by-detection-error">Q1: How are estimates of community stability shaped by detection error?</h3>
</section>
<section id="q2-how-is-community-stability-through-time-shaped-by-environmental-factors" class="level3">
<h3 class="anchored" data-anchor-id="q2-how-is-community-stability-through-time-shaped-by-environmental-factors">Q2: How is community stability through time shaped by environmental factors?</h3>
</section>
</section>
<section id="approach" class="level2">
<h2 class="anchored" data-anchor-id="approach">Approach</h2>
<p>In our two-part modeling framework, we are first inputting raw survey data from a community along with covariates to detection into a multi-species occupancy or abuandance model. Then, we are deriving mean values of community change (‘beta diversity’) along with uncertainty in these values (standard deviation). Finally, we are inputting these values into a regression model that incorporates current and lagged effects of environmental covariates via the stochastic antecedent modeling (SAM) framework to understand how the environment (both biotic and abiotic) shapes community change/stability.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="pictures/model_conceptual.jpg" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figure 1: Depiction of the modeling process, in which yellow circles depict data (inputs and outputs) and blue boxes represent models.</figcaption>
</figure>
</div>
</section>
<section id="datasets" class="level2">
<h2 class="anchored" data-anchor-id="datasets">Datasets</h2>
<p>Our aim is to demonstrate the general utility of the modeling process as a way to unify community ecology sub-disciplines that have historical differences in how they analyze data. Thus, we have compiled a set of four datasets across taxonomic groups and environments to highlight the general utility of our approach.</p>
<section id="santa-barbara-channel-lter-fish-community" class="level3">
<h3 class="anchored" data-anchor-id="santa-barbara-channel-lter-fish-community">Santa Barbara Channel LTER fish community</h3>
<p>Our first dataset is from surveys of fish in the Santa Barbara Channel LTER (SBC LTER) that span from 2000-2022.</p>
<ul>
<li><strong>Taxa</strong>: Fish</li>
<li><strong>Environment</strong>: Marine - Kelp forest</li>
<li><strong>Years</strong>: 23</li>
<li><strong>Number of sites</strong>: 43</li>
<li><strong>Number of species</strong>: 63</li>
<li><strong>Data Type</strong>: Abundance</li>
<li><strong>Detection covariates</strong>: fish size and dive visibility</li>
<li><strong>Environmental covariates</strong>: seasonal temperature and annual giant kelp biomass</li>
</ul>
</section>
<section id="konza-prairie-lter-bird-community" class="level3">
<h3 class="anchored" data-anchor-id="konza-prairie-lter-bird-community">Konza Prairie LTER bird community</h3>
<p>The second dataset is from surveys of grassland birds in the Konza Prairie LTER (KNZ LTER) that span from 1981-2009.</p>
<ul>
<li><strong>Taxa</strong>: Birds</li>
<li><strong>Environment</strong>: Terrestrial - Tallgrass prairie</li>
<li><strong>Years</strong>: 28</li>
<li><strong>Number of sites</strong>: 3-11 (still WIP)</li>
<li><strong>Number of species</strong>: TBD</li>
<li><strong>Data Type</strong>: Abundance</li>
<li><strong>Detection covariates</strong>: bird size and survey length</li>
<li><strong>Environmental covariates</strong>: seasonal temperature, precipitation, (and potentially annual plant biomass)</li>
</ul>
</section>
<section id="sevilleta-lter-grasshopper-community" class="level3">
<h3 class="anchored" data-anchor-id="sevilleta-lter-grasshopper-community">Sevilleta LTER grasshopper community</h3>
<p>The third dataset is from surveys of grasshoppers in the Sevilleta LTER (SEV LTER) that span from 1992-2019.</p>
<ul>
<li><strong>Taxa</strong>: Insects</li>
<li><strong>Environment</strong>: Terrestrial - Blue gramma grassland and Creosote shrubland</li>
<li><strong>Years</strong>: 27</li>
<li><strong>Number of sites</strong>: 60</li>
<li><strong>Number of species</strong>: 46</li>
<li><strong>Data Type</strong>: Abundance</li>
<li><strong>Detection covariates</strong>: none (none provided in metadata, others not easy to derive (e.g.&nbsp;body size) from literature review)</li>
<li><strong>Environmental covariates</strong>: seasonal temperature and plant biomass</li>
</ul>
</section>
<section id="petrified-forest-national-park-plant-community" class="level3">
<h3 class="anchored" data-anchor-id="petrified-forest-national-park-plant-community">Petrified Forest National Park plant community</h3>
<p>The final dataset is a set of surveys of understory plant communities in Petrified Forest National Park (PFNP) that span from 2007-2022.</p>
<ul>
<li><strong>Taxa</strong>: Plants</li>
<li><strong>Environment</strong>: Terrestrial - Grassland and shrubland</li>
<li><strong>Years</strong>: 15</li>
<li><strong>Number of sites</strong>: 10 (subset because of computation time)</li>
<li><strong>Number of species</strong>: TBD</li>
<li><strong>Data Type</strong>: Presence-Absence (Detection/Nondetection)</li>
<li><strong>Detection covariates</strong>: cover class</li>
<li><strong>Environmental covariates</strong>: seasonal precipitation and VPD</li>
</ul>
</section>
</section>
<section id="progress-so-far" class="level2">
<h2 class="anchored" data-anchor-id="progress-so-far">Progress so far</h2>
<section id="sbc-lter-fish-dataset" class="level3">
<h3 class="anchored" data-anchor-id="sbc-lter-fish-dataset">SBC LTER fish dataset</h3>
<ul>
<li><strong>Detection model</strong>: complete</li>
<li><strong>SAM regression model</strong>: complete</li>
</ul>
</section>
<section id="knz-lter-bird-dataset" class="level3">
<h3 class="anchored" data-anchor-id="knz-lter-bird-dataset">KNZ LTER bird dataset</h3>
<ul>
<li><strong>Detection model</strong>: WIP</li>
<li><strong>SAM regression model</strong>: not run</li>
</ul>
</section>
<section id="sev-lter-grasshopper-dataset" class="level3">
<h3 class="anchored" data-anchor-id="sev-lter-grasshopper-dataset">SEV LTER grasshopper dataset</h3>
<ul>
<li><strong>Detection model</strong>: complete</li>
<li><strong>SAM regression model</strong>: complete</li>
</ul>
</section>
<section id="pfnp-plant-dataset" class="level3">
<h3 class="anchored" data-anchor-id="pfnp-plant-dataset">PFNP plant dataset</h3>
<ul>
<li><strong>Detection model</strong>: WIP</li>
<li><strong>SAM regression model</strong>: not run</li>
</ul>
</section>
</section>
<section id="potential-figures-and-follow-up-analyses" class="level2">
<h2 class="anchored" data-anchor-id="potential-figures-and-follow-up-analyses">Potential figures and follow-up analyses</h2>
<p>Following are a set of potential figures we could consider including the paper (or supplements) along with follow-up analyses associated with these.</p>
<section id="q1-detection-error" class="level3">
<h3 class="anchored" data-anchor-id="q1-detection-error">Q1: Detection error</h3>
<section id="covariates-driving-detection" class="level4">
<h4 class="anchored" data-anchor-id="covariates-driving-detection">Covariates driving detection</h4>
<p>When thinking about detection, we could look at how covariates we input into the model influence our ability to detect species:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="pictures/detection_models/detection_covariate_effects.jpg" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figure 2: Detection of fish in the SBC LTER is shaped by fish body size and dive visibility. Smaller fish are easier to detect (likely related to school sizes) and detection is higher during dives with greater visibility.</figcaption>
</figure>
</div>
</section>
<section id="accounting-for-detection-error-change-and-estimates-of-change" class="level4">
<h4 class="anchored" data-anchor-id="accounting-for-detection-error-change-and-estimates-of-change">Accounting for detection error change and estimates of change</h4>
<p>We could also look at how observed versus modeled estimates of dissimilarity compare:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="pictures/detection_models/observed_modeled_violin.jpg" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figure 3: Dissimilarity (either Bray-Curtis or Jaccard, depending on data type) computed with the modeled data (yellow) and observed data (blue) on species abundances or presences. Values closer to one correspond to more community change. For both the SEV LTER grasshopper and SBC LTER fish datasets, accounting for detection error (“modeled” data) reduces variance in estimates and reduces the mean estimate of dissimilarity (less change).</figcaption>
</figure>
</div>
<p>In this case, we could perform a post-hoc analysis of whether estimates of dissimilarity change with data type (observed versus modeled) and whether this varies by dataset. This could be a quick frequentist model (glmm with random effects of site-year as a “repeated measures” and covariates of data type, dataset ID, and their interaction) or could be a follow-up Bayesian model.</p>
</section>
<section id="temporal-trends-in-change-with-and-without-detection-error" class="level4">
<h4 class="anchored" data-anchor-id="temporal-trends-in-change-with-and-without-detection-error">Temporal trends in change with and without detection error</h4>
<p>We might also illustrate how variable the two types of data (observed versus modeled) are over time, using a few sites as illustration:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="pictures/detection_models/observed_modeled_timeseries.jpg" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figure 4: An example of a timeseries of community change where observed (blue) and modeled (yellow) change for one site in each dataset is illustrated through the entire timeseries. Again, values closer to one correspond to higher change in the community.</figcaption>
</figure>
</div>
</section>
<section id="qualitative-assessment-of-detection-probabilities" class="level4">
<h4 class="anchored" data-anchor-id="qualitative-assessment-of-detection-probabilities">Qualitative assessment of detection probabilities</h4>
<p>Depending on whether datasets greatly vary in their observed versus modeled estimates, we could do an qualitative assessment of whether this is related to relative “rarity” in the dataset, based on the distribution of detection probabilities for each species in the dataset:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="pictures/detection_models/species_detection_probabilities.jpg" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figure 5</figcaption>
</figure>
</div>
</section>
</section>
<section id="q2-environmental-drivers" class="level3">
<h3 class="anchored" data-anchor-id="q2-environmental-drivers">Q2: Environmental drivers</h3>
<p>For regression models, we could illustrate the effects of all covariates in the model: all model estimates plot <img src=".png" class="img-fluid" alt="Figure 6"></p>
<p>As well as demonstrate how important variables shape community change as well as whether these effects are relatively instantaneous or lagged: sam partial plots <img src=".png" class="img-fluid" alt="Figure 7"></p>
</section>
<section id="figure-feedback" class="level3">
<h3 class="anchored" data-anchor-id="figure-feedback">Figure feedback</h3>
<p>We are limited to 6 figures and tables in the paper, and many of these figures could be multi-panel to highlight all four datasets. Do you all have thoughts on your favorite ways to visualize the datasets, given our goals in this paper?</p>
</section>
</section>
<section id="final-thoughts" class="level2">
<h2 class="anchored" data-anchor-id="final-thoughts">Final thoughts</h2>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>